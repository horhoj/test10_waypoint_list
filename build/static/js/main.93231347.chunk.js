(this.webpackJsonpxxx=this.webpackJsonpxxx||[]).push([[0],{16:function(t,e,n){t.exports={wrap:"MapViewer_wrap__YE6Rm",helper:"MapViewer_helper__1qzpZ",mapWrap:"MapViewer_mapWrap__2po7h"}},19:function(t,e,n){t.exports={wrap:"App_wrap__2K2ND"}},29:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var a={};n.r(a),n.d(a,"getWaypointIdList",(function(){return j})),n.d(a,"getWaypointsData",(function(){return b})),n.d(a,"getCurrentMapCenter",(function(){return f}));var i=n(0),o=n.n(i),c=n(7),r=n.n(c),p=n(6),s=n(4),l=n(8),d=n(13),u=function(){return Object(p.c)()},y=p.d,j=function(t){return t.app.waypointIdList},b=function(t){return t.app.waypointsData},f=function(t){return t.app.currentMapCenter},w=n(17),x=n(12),O=[55.75,37.57],m={waypointIdList:[1,2,3,4],waypointsData:{1:{title:"\u0422\u043e\u0447\u043a\u0430 1",location:[55.65,37.17]},2:{title:"\u0422\u043e\u0447\u043a\u0430 2",location:[55.55,37.27]},3:{title:"\u0422\u043e\u0447\u043a\u0430 3",location:[55.75,37.37]},4:{title:"\u0422\u043e\u0447\u043a\u0430 4",location:[55.76,37.79]}},currentMapCenter:O},h=Object(x.b)({name:"app",initialState:m,reducers:{setCurrentMapCenter:function(t,e){t.currentMapCenter=e.payload},addWaypoint:function(t,e){var n=Math.max.apply(Math,Object(w.a)(t.waypointIdList)),a=1;Number.isNaN(n)||n===-1/0||(a=n+1),t.currentMapCenter=[t.currentMapCenter[0],t.currentMapCenter[1]+.05],t.waypointsData[a]={title:e.payload,location:t.currentMapCenter},t.waypointIdList.push(a)},deleteWaypoint:function(t,e){t.waypointIdList=t.waypointIdList.filter((function(t){return t!==e.payload})),delete t.waypointsData[e.payload]},editWaypointTitle:function(t,e){var n=e.payload,a=n.id,i=n.newTitle;t.waypointsData[a]=Object(s.a)(Object(s.a)({},t.waypointsData[a]),{},{title:i})},editWaypointLocation:function(t,e){var n=e.payload,a=n.id,i=n.newWaypointLocation;t.waypointsData[a].location=i},dragWaypoint:function(t,e){var n,a=e.payload,i=a.oldIndex,o=a.newIndex,c=t.waypointIdList.splice(i,1);(n=t.waypointIdList).splice.apply(n,[o,0].concat(Object(w.a)(c)))}}}),_=a,v=h.actions,W=h.reducer,g=n(5),L=n.n(g),I=n(2),C=function(t){var e=t.onEnterNewValue,n=t.autoFocus,a=void 0!==n&&n,o=t.defaultValue,c=void 0===o?"":o,r=t.onCancel,p=void 0===r?null:r,d=t.className,u=void 0===d?"":d,y=t.dataTestId,j=void 0===y?"":y,b=Object(i.useState)(c),f=Object(l.a)(b,2),w=f[0],x=f[1],O={};j&&(O["data-testid"]=j);return Object(I.jsx)("input",Object(s.a)({type:"text",className:u,placeholder:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u0443\u044e \u0442\u043e\u0447\u043a\u0443",value:w,onChange:function(t){return x(t.target.value)},onKeyDown:function(t){var n=w.trim();"Enter"===t.key&&n&&(e(w),x(""))},autoFocus:a,onBlur:function(){p&&p()}},O))},N=function(){var t=Object(i.useState)(null),e=Object(l.a)(t,2),n=e[0],a=e[1],o=y(_.getWaypointsData),c=y(_.getWaypointIdList),r=u();return Object(I.jsxs)("div",{className:L.a.wrap,children:[Object(I.jsx)("div",{children:Object(I.jsx)(C,{onEnterNewValue:function(t){r(v.addWaypoint(t))},className:L.a.inputAddWaypoint,dataTestId:"add_new_waypoint_title_input"})}),Object(I.jsx)("div",{className:L.a.waypointListHelper,children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0434\u043b\u044f \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u043f\u043e\u0440\u044f\u0434\u043a\u0430. \u041c\u0430\u0440\u0448\u0440\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0441\u0442\u0440\u043e\u0435\u043d \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438."}),Object(I.jsx)(d.a,{onDragEnd:function(t){var e=t.destination,n=t.source,a=null===e||void 0===e?void 0:e.index;"number"===typeof a&&r(v.dragWaypoint({oldIndex:n.index,newIndex:a}))},children:Object(I.jsx)(d.c,{type:"statusLane",droppableId:"waypoint-list-droppable",direction:"vertical",children:function(t){return Object(I.jsxs)("ul",Object(s.a)(Object(s.a)({className:L.a.waypointList},t.droppableProps),{},{ref:t.innerRef,children:[c.map((function(t,e){return Object(I.jsx)(d.b,{draggableId:t.toString(),index:e,isDragDisabled:null!==n,children:function(e){return Object(I.jsx)("li",Object(s.a)(Object(s.a)(Object(s.a)({ref:e.innerRef},e.dragHandleProps),e.draggableProps),{},{"data-testid":"waypoint_item=".concat(t),children:Object(I.jsxs)("span",{className:L.a.waypointItem,children:[Object(I.jsx)("span",{className:L.a.waypointItemTitle,children:n===t?Object(I.jsx)(C,{className:L.a.inputEditWaypointTitle,autoFocus:!0,defaultValue:o[t].title,onEnterNewValue:function(e){var n,i;n=t,i=e,r(v.editWaypointTitle({id:n,newTitle:i})),a(null)},onCancel:function(){return a(null)}}):Object(I.jsx)("span",{className:L.a.inputEditWaypointTitleSpan,children:o[t].title})}),Object(I.jsxs)("span",{className:L.a.waypointItemLocation,children:["[",o[t].location[0].toFixed(2),", ",o[t].location[1].toFixed(2),"]"]}),Object(I.jsx)("button",{type:"button",className:L.a.patchItemButton,onClick:function(){return a(t)},children:"E"}),Object(I.jsx)("button",{type:"button",className:L.a.deleteItemButton,onClick:function(){return e=t,void r(v.deleteWaypoint(e));var e},"data-testid":"delete_waypoint_item_btn=".concat(t),children:"X"})]})}),t)}},t)})),t.placeholder]}))}})})]})},E=n(10),D=n(16),M=n.n(D),T=function(t,e,n){return'<p style="display: flex">\n     <span \n        style="\n          font-weight: 500; \n          font-size: 110%; \n          overflow: hidden; \n          text-overflow: ellipsis; \n          max-width: 120px; \n          display: inline-block"\n      >\n        '.concat(t[n].title,"\n      </span>&nbsp;\n      <span>\n        ").concat(e,"\n      </span>\n    </p>")},S={center:O,zoom:9},k=function(){var t=u(),e=y(_.getWaypointIdList),n=y(_.getWaypointsData),a=function(e){return function(n){var a=n.get("target").geometry.getCoordinates(),i=v.editWaypointLocation({id:e,newWaypointLocation:a});t(i)}},o=[];e.forEach((function(t){o.push(n[t].location)}));var c=Object(i.useRef)(null),r=Object(i.useState)(671),p=Object(l.a)(r,2),s=p[0],d=p[1],j=Object(i.useCallback)((function(){if(c.current){var t=c.current.getBoundingClientRect().width;d(t)}}),[]);return Object(i.useEffect)((function(){j()}),[e]),Object(i.useEffect)((function(){return j(),window.addEventListener("resize",j),function(){window.removeEventListener("resize",j)}}),[]),Object(I.jsxs)("div",{className:M.a.wrap,style:{minHeight:"".concat(s+40,"px")},children:[Object(I.jsx)("div",{className:M.a.helper,children:"\u043c\u0435\u0442\u043a\u0438 \u043d\u0430 \u043a\u0430\u0440\u0442\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0442\u0430\u0441\u043a\u0438\u0432\u0430\u0442\u044c"}),Object(I.jsx)(E.d,{children:Object(I.jsx)("div",{ref:c,children:Object(I.jsxs)(E.a,{onActionEnd:function(e){var n=e.originalEvent.map.getCenter();t(v.setCurrentMapCenter(n))},defaultState:S,width:"".concat(s,"px"),height:"".concat(s,"px"),children:[e.map((function(t){var e,i,o=(e=n[t].location,"[".concat(e[0].toFixed(2),", ").concat(e[1].toFixed(2),"]"));return Object(I.jsx)(E.b,{geometry:n[t].location,options:{draggable:!0,preset:"islands#blueStretchyIcon"},properties:{iconContent:T(n,o,t),hintContent:(i=n[t].title,"<p style='font-size: 130%; padding: 5px'>".concat(i,"</p>")),balloonContentHeader:n[t].title,balloonContent:o},onDragEnd:a(t),modules:["geoObject.addon.balloon","geoObject.addon.hint"]},t)})),Object(I.jsx)(E.c,{geometry:o,options:{balloonCloseButton:!1,strokeColor:"#090",strokeWidth:7,strokeOpacity:.8}})]})})})]})},B=n(19),V=n.n(B),z=function(){return Object(I.jsxs)("div",{className:V.a.wrap,children:[Object(I.jsx)(N,{}),Object(I.jsx)(k,{})]})},A=(n(29),Object(x.a)({devTools:!0,reducer:{app:W}}));r.a.render(Object(I.jsx)(o.a.StrictMode,{children:Object(I.jsx)(p.a,{store:A,children:Object(I.jsx)(z,{})})}),document.getElementById("root"))},5:function(t,e,n){t.exports={wrap:"WaypointList_wrap__3Cqch",waypointListHelper:"WaypointList_waypointListHelper__oZnXz",waypointList:"WaypointList_waypointList__2f815",inputAddWaypoint:"WaypointList_inputAddWaypoint__1LICh",inputEditWaypointTitle:"WaypointList_inputEditWaypointTitle__dSepo",inputEditWaypointTitleSpan:"WaypointList_inputEditWaypointTitleSpan__1A-j2",waypointItem:"WaypointList_waypointItem__6ZAeo",deleteItemButton:"WaypointList_deleteItemButton__2mCu8",patchItemButton:"WaypointList_patchItemButton__1bS8i",waypointItemTitle:"WaypointList_waypointItemTitle__ciCvn",waypointItemLocation:"WaypointList_waypointItemLocation__1bdnk"}}},[[30,1,2]]]);
//# sourceMappingURL=main.93231347.chunk.js.map